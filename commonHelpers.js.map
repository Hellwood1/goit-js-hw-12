{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\"use strict\";\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/?';\nconst API_KEY = '41881692-6f4b64110761e7ecb64cd986a';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nlet page = 1;\nlet searchQuery = '';\nlet totalHits = 0;\n\nconst form = document.querySelector('.form');\nconst myGallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst searchParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nconst showMessage = (message, backgroundColor, messageSize) => {\n  iziToast.show({\n    message: message,\n    backgroundColor: backgroundColor,\n    messageColor: '#FFFFFF',\n    maxWidth: 300,\n    timeout: 2000,\n    progressBar: false,\n    position: 'topRight',\n    transitionIn: 'bounceInRight',\n    transitionOut: 'fadeOutLeft',\n    messageSize: messageSize,\n  });\n};\n\nconst clearGallery = () => {\n  myGallery.innerHTML = '';\n};\n\nconst toggleLoader = (state) => {\n  loader.style.display = state ? 'block' : 'none';\n};\n\nconst scrollPageByGalleryCardHeight = () => {\n  const firstGalleryCard = myGallery.querySelector('.gallery-item');\n\n  if (firstGalleryCard) {\n    const cardHeight = firstGalleryCard.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n};\n\nconst renderImage = (image) => `\n  <li class='gallery-item'>\n    <a href=\"${image.largeImageURL}\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n    </a>\n    <div class='info-container'>\n      <div>\n        <h3 class='card-title'>Likes</h3>\n        <p class='card-info'>${image.likes}</p>\n      </div>\n      <div>\n        <h3 class='card-title'>Views</h3>\n        <p class='card-info'>${image.views}</p>\n      </div>\n      <div>\n        <h3 class='card-title'>Comments</h3>\n        <p class='card-info'>${image.comments}</p>\n      </div>\n      <div>\n        <h3 class='card-title'>Downloads</h3>\n        <p class='card-info'>${image.downloads}</p>\n      </div>\n    </div>\n  </li>`;\n\nconst fetchData = async (searchParams) => {\n  try {\n    const response = await axios.get(`${BASE_URL}${new URLSearchParams(searchParams)}`);\n\n    if (response.status !== 200) {\n      throw new Error(`Something went wrong. Please try again later.`);\n    }\n\n    const { hits, totalHits: newTotalHits } = response.data;\n\n    return { hits, newTotalHits };\n  } catch (error) {\n    console.error(error.message);\n    return { hits: [], newTotalHits: 0 };\n  }\n};\n\nconst handleApiResponse = async (searchParams) => {\n  toggleLoader(true);\n  const { hits, newTotalHits } = await fetchData(searchParams);\n  toggleLoader(false);\n\n  if (hits.length === 0) {\n    showMessage('Sorry, there are no images matching your search query. Please try again!', '#EF4040', 12);\n  } else {\n    hits.forEach((image) => {\n      myGallery.innerHTML += renderImage(image);\n    });\n\n    lightbox.refresh();\n    totalHits = newTotalHits;\n\n    if (myGallery.children.length >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      showMessage(\"We're sorry, but you've reached the end of search results.\", '#4e75ff', 14);\n    } else {\n      loadMoreButton.style.display = 'block';\n      scrollPageByGalleryCardHeight();\n    }\n  }\n};\n\nconst handleFormSubmit = async (event) => {\n  event.preventDefault();\n\n  searchQuery = event.target.elements.search.value.trim();\n\n  if (!searchQuery) {\n    showMessage('Please enter a valid search query!', '#EF4040', 12);\n    return;\n  }\n\n  page = 1;\n  clearGallery();\n\n  searchParams.q = searchQuery;\n  handleApiResponse(searchParams);\n};\n\nconst handleLoadMore = async () => {\n  searchParams.page = page;\n  handleApiResponse(searchParams);\n};\n\nloadMoreButton.style.display = 'none';\n\nloadMoreButton.addEventListener('click', async () => {\n  toggleLoader(true);\n  page += 1;\n  await handleLoadMore();\n  toggleLoader(false);\n});\n\nform.addEventListener('submit', handleFormSubmit);\n"],"names":["BASE_URL","API_KEY","lightbox","SimpleLightbox","page","searchQuery","totalHits","form","myGallery","loader","loadMoreButton","searchParams","showMessage","message","backgroundColor","messageSize","iziToast","clearGallery","toggleLoader","state","scrollPageByGalleryCardHeight","firstGalleryCard","cardHeight","renderImage","image","fetchData","response","axios","hits","newTotalHits","error","handleApiResponse","handleFormSubmit","event","handleLoadMore"],"mappings":"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"}